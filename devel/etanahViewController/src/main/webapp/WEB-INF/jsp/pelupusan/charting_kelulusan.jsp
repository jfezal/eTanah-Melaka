<%-- 
    Document   : charting_kelulusan
    Created on : Dec 30, 2009, 9:29:55 AM
    Author     : nursyazwani
--%>

<%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<%@ taglib uri="http://displaytag.sf.net" prefix="display" %>
<%@ include file="/WEB-INF/jsp/include/page_header.jspf" %>
<link type="text/css" href="${pageContext.request.contextPath}/styles/ui-lightness/jquery-ui-1.7.2.custom.css" rel="stylesheet" />

<script type="text/javascript">
    
    function RunProgram(strUserID, strNama, strJawatan, strIDPermohonan, strStageID) {
		
        var strNama2 = ReplaceAll(strNama," ","_");
        var strJawatan2 = ReplaceAll(strJawatan," ","_");
        var strStageID2 = "g_penyediaan_tol";
        var objShell = new ActiveXObject("WScript.Shell");
        var sysVar = objShell.Environment("System");
        //objShell.run("C:\Program Files\EpiWeb\ArcMap_ActiveX_Initializer\InititializeArcMap.exe");
        //objShell.run("C:\Program Files\eTanahStrata\InititializeStrata.exe")


        objShell.Run(sysVar("eTanahGISLIM") + " " + strUserID + " " + strNama2 + " " +  strJawatan2 + " " + strIDPermohonan + " " + strStageID2);
    }
    function RunProgramPermit(strUserID, strNama, strJawatan, strIDPermohonan, strStageID) {
		
        var strNama2 = ReplaceAll(strNama," ","_");
        var strJawatan2 = ReplaceAll(strJawatan," ","_");
        var strStageID2 = "g_penyediaan_permit";
        var objShell = new ActiveXObject("WScript.Shell");
        var sysVar = objShell.Environment("System");
        //objShell.run("C:\Program Files\EpiWeb\ArcMap_ActiveX_Initializer\InititializeArcMap.exe");
        //objShell.run("C:\Program Files\eTanahStrata\InititializeStrata.exe")


        objShell.Run(sysVar("eTanahGISLIM") + " " + strUserID + " " + strNama2 + " " +  strJawatan2 + " " + strIDPermohonan + " " + strStageID2);
    }
    function RunProgram2(strUserID, strNama, strJawatan, strIDPermohonan, strStageID) {

        var strNama2 = ReplaceAll(strNama," ","_");
        var strJawatan2 = ReplaceAll(strJawatan," ","_");
        var strStageID2 = "g_charting_keputusan";
        var objShell = new ActiveXObject("WScript.Shell");
        var sysVar = objShell.Environment("System");
        //objShell.run("C:\Program Files\EpiWeb\ArcMap_ActiveX_Initializer\InititializeArcMap.exe");
        //objShell.run("C:\Program Files\eTanahStrata\InititializeStrata.exe")


        objShell.Run(sysVar("eTanahGISLIM") + " " + strUserID + " " + strNama2 + " " +  strJawatan2 + " " + strIDPermohonan + " " + strStageID2);
    }
    function RunProgram3(strUserID, strNama, strJawatan, strIDPermohonan, strStageID) {

        var strNama2 = ReplaceAll(strNama," ","_");
        var strJawatan2 = ReplaceAll(strJawatan," ","_");
//        var strStageID2 = "g_charting_keputusan";
        var strStageID2 = "g_charting_semak";
        var objShell = new ActiveXObject("WScript.Shell");
        var sysVar = objShell.Environment("System");
        //objShell.run("C:\Program Files\EpiWeb\ArcMap_ActiveX_Initializer\InititializeArcMap.exe");
        //objShell.run("C:\Program Files\eTanahStrata\InititializeStrata.exe")


        objShell.Run(sysVar("eTanahGISLIM") + " " + strUserID + " " + strNama2 + " " +  strJawatan2 + " " + strIDPermohonan + " " + strStageID2);
    }
    function RunProgram4(strUserID, strNama, strJawatan, strIDPermohonan, strStageID) {

        var strNama2 = ReplaceAll(strNama," ","_");
        var strJawatan2 = ReplaceAll(strJawatan," ","_");
        var strStageID2 = "g_kemaskini_hakmilik";
        var objShell = new ActiveXObject("WScript.Shell");
        var sysVar = objShell.Environment("System");
        //objShell.run("C:\Program Files\EpiWeb\ArcMap_ActiveX_Initializer\InititializeArcMap.exe");
        //objShell.run("C:\Program Files\eTanahStrata\InititializeStrata.exe")


        objShell.Run(sysVar("eTanahGISLIM") + " " + strUserID + " " + strNama2 + " " +  strJawatan2 + " " + strIDPermohonan + " " + strStageID2);
    }
    
    function RunProgram5(strUserID, strNama, strJawatan, strIDPermohonan, strStageID) {

        var strNama2 = ReplaceAll(strNama," ","_");
        var strJawatan2 = ReplaceAll(strJawatan," ","_");
        var strStageID2 = "g_kemaskini_warta";
        var objShell = new ActiveXObject("WScript.Shell");
        var sysVar = objShell.Environment("System");
        //objShell.run("C:\Program Files\EpiWeb\ArcMap_ActiveX_Initializer\InititializeArcMap.exe");
        //objShell.run("C:\Program Files\eTanahStrata\InititializeStrata.exe")


        objShell.Run(sysVar("eTanahGISLIM") + " " + strUserID + " " + strNama2 + " " +  strJawatan2 + " " + strIDPermohonan + " " + strStageID2);
    }
    
    function RunProgram6(strUserID, strNama, strJawatan, strIDPermohonan, strStageID) {

        var strNama2 = ReplaceAll(strNama," ","_");
        var strJawatan2 = ReplaceAll(strJawatan," ","_");
        var strStageID2 = "g_penyediaan_pt";
        var objShell = new ActiveXObject("WScript.Shell");
        var sysVar = objShell.Environment("System");
        //objShell.run("C:\Program Files\EpiWeb\ArcMap_ActiveX_Initializer\InititializeArcMap.exe");
        //objShell.run("C:\Program Files\eTanahStrata\InititializeStrata.exe")


        objShell.Run(sysVar("eTanahGISLIM") + " " + strUserID + " " + strNama2 + " " +  strJawatan2 + " " + strIDPermohonan + " " + strStageID2);
    }

    function RunProgram7(strUserID, strNama, strJawatan, strIDPermohonan, strStageID) {

        var strNama2 = ReplaceAll(strNama," ","_");
        var strJawatan2 = ReplaceAll(strJawatan," ","_");
        var strStageID2 = "g_charting_ft";
        var objShell = new ActiveXObject("WScript.Shell");
        var sysVar = objShell.Environment("System");
        //objShell.run("C:\Program Files\EpiWeb\ArcMap_ActiveX_Initializer\InititializeArcMap.exe");
        //objShell.run("C:\Program Files\eTanahStrata\InititializeStrata.exe")


        objShell.Run(sysVar("eTanahGISLIM") + " " + strUserID + " " + strNama2 + " " +  strJawatan2 + " " + strIDPermohonan + " " + strStageID2);
    }
    
    function ReplaceAll(Source,stringToFind,stringToReplace){
        var temp = Source;
        var index = temp.indexOf(stringToFind);
        while(index != -1){
            temp = temp.replace(stringToFind,stringToReplace);
            index = temp.indexOf(stringToFind);

        }
        return temp;
    }
   </script>

<s:form beanclass="etanah.view.stripes.pelupusan.ChartingKelulusanActionBean">
    <s:messages/>
    <s:errors/>
   <div class="subtitle">
       <fieldset class="aras1">
           <legend>Charting Kelulusan</legend>
               <p>
                   <label>ID Permohonan:</label>
                   ${actionBean.permohonan.idPermohonan}&nbsp;
               </p>
               <c:if test="${actionBean.permohonan.kodUrusan.kod ne 'PWGSA'}">   
               <p>
                   <label>Keputusan: </label>
                   <c:if test="${actionBean.permohonan.keputusan.kod eq 'L'}">Lulus</c:if>
                   <c:if test="${actionBean.permohonan.keputusan.kod eq 'T'}">Tolak</c:if>
               </p>
                </c:if>
               <c:if test="${actionBean.kodNegeri eq '05'}">
                   <c:if test="${actionBean.permohonan.kodUrusan.kod eq 'PCRG' || actionBean.permohonan.kodUrusan.kod eq 'LPJH'}">
                       <p>
                           <label>Luas Diluluskan: </label>
                           ${actionBean.hakmilikPermohonan.luasDiluluskan}
                           ${actionBean.hakmilikPermohonan.luasLulusUom.nama}
                       </p>
                   </c:if>
                </c:if>
       </fieldset>
   </div>

   <p>
        <label>&nbsp;</label>
        <c:if test="${actionBean.stageId eq 'g_charting_4a'}">
          <s:button name="charting" value="Charting" class="btn" onclick="RunProgram('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq 'g_charting_kelulusan'}">
          <s:button name="charting" value="Charting" class="btn" onclick="RunProgramPermit('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq 'g_charting_4d'}">
          <s:button name="charting" value="Charting" class="btn" onclick="RunProgramPermit('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
          <c:if test="${actionBean.stageId eq 'g_charting_maklumat_rizab'}">
          <s:button name="charting" value="Charting" class="btn" onclick="RunProgramPermit('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
             <c:if test="${actionBean.stageId eq 'semak_charting_kelulusan'}">
          <s:button name="charting" value="Charting" class="btn" onclick="RunProgramPermit('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
         <c:if test="${actionBean.stageId eq 'g_charting_keputusan' || actionBean.stageId eq 'g_charting_kpsn_T1' || actionBean.stageId eq '18AChartingKeputusan' || actionBean.stageId eq '57AChartingKeputusan'}">
              <s:button name="charting" id="btnClick" value="Charting" class="btn" onclick="RunProgram2('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.permohonan.idPermohonan}','${actionBean.stageId}');"/>
        </c:if>
          <c:if test="${actionBean.stageId eq 'semak_charting_keputusan' || actionBean.stageId eq 'semak_charting_kpsn_T1'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram3('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq 'semak_charting_kpsn'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram3('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq '35aSemakan'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram3('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
         <c:if test="${actionBean.stageId eq 'semakan_charting_keputusan'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram3('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq '19MklmnWartadanChartg'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram3('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq '26Chrtg'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram3('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq '24ChrtgKptsan'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram3('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
         <c:if test="${actionBean.stageId eq '27Smkn'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram3('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
         <c:if test="${actionBean.stageId eq 'semak_cmr'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgramPermit('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq 'g_kemaskini_hakmilik'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram4('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq 'keputusantolak'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram2('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
         <c:if test="${actionBean.stageId eq '35.1Semakan'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram3('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
         <c:if test="${actionBean.stageId eq '32ChrtgKelulusan'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram3('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq 'g_charting_kemaskini'}">
        <s:button name="charting" value="Charting" class="btn" onclick="RunProgram4('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
        <c:if test="${actionBean.stageId eq 'g_kemaskini_warta'}">
              <s:button name="" id="btnClick" value="Kemaskini" class="btn" onclick="RunProgram5('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.permohonan.idPermohonan}','${actionBean.stageId}');"/>
        </c:if>
         <c:if test="${actionBean.stageId eq 'g_penyediaan_pt'}">
              <s:button name="charting" id="btnClick" value="Charting" class="btn" onclick="RunProgram6('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.permohonan.idPermohonan}','${actionBean.stageId}');"/>
        </c:if>
        <%--actionBean.stageId eq 'g_kemaskini_hakmilik' and--%> 
        <c:if test="${actionBean.permohonan.kodUrusan.kod eq 'PRIZ'}">
        <s:button name="charting" value="Kemaskini Warta" class="btn" onclick="RunProgram5('${actionBean.peng.idPengguna}','${actionBean.peng.nama}','${actionBean.peng.jawatan}','${actionBean.idPermohonan}','${actionBean.stageId}');"/>&nbsp;
        </c:if>
   </p>
</s:form>
  
